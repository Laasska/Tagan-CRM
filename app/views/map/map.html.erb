<a href="#" id="maps" >
<%= @user.live_in_city %></a>

<!-- Large modal -->
<div class="modal fade" id="maps-modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div id="map">
      </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
        <button type="button" class="btn btn-primary">Сохранить изменения</button>
    </div>
  </div>
</div>

<script  type="text/javascript" charset="utf-8">
  $('#maps').on('click', function () {

    $('#maps-modal').modal('show');
    setTimeout(initMap,1000);

  })

 function initMap() {
   var map = new google.maps.Map(document.getElementById('map'), {
     center: {lat: 0, lng: 0},
     zoom: 2
   });

   var service = new google.maps.places.PlacesService(map);
       service.getDetails({
         placeId: '<%= @user.place_id%>'
       }, function(place, status) {
         if (status === google.maps.places.PlacesServiceStatus.OK) {
           var marker = new google.maps.Marker({
             map: map,
             position: place.geometry.location
           });
           google.maps.event.addListener(marker, 'click', function() {
             infowindow.setContent(place.name);
             infowindow.open(map, this);
           });
         }
       });


 }

</script>

